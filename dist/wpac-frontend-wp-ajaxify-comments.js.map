{"version":3,"file":"wpac-frontend-wp-ajaxify-comments.js","mappings":"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","sources":["webpack://wp-ajaxify-comments/./src/js/frontend/wp-ajaxify-comments.js"],"sourcesContent":["WPAC._Options = WPAC._Options || {}; \r\n\r\nWPAC._BodyRegex = new RegExp(\"<body[^>]*>((.|\\n|\\r)*)</body>\", \"i\");\r\nWPAC._ExtractBody = function(html) {\r\n\ttry {\r\n\t\treturn jQuery(\"<div>\"+WPAC._BodyRegex.exec(html)[1]+\"</div>\");\r\n\t} catch (e) {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nWPAC._TitleRegex = new RegExp(\"<title[^>]*>(.*?)<\\\\/title>\", \"im\");\r\nWPAC._ExtractTitle = function(html) {\r\n\ttry {\r\n\t\treturn WPAC._TitleRegex.exec(html)[1];\r\n\t} catch (e) {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nWPAC._ShowMessage = function (message, type) {\r\n\r\n\tvar top = WPAC._Options.popupMarginTop + (jQuery(\"#wpadminbar\").outerHeight() || 0);\r\n\r\n\tvar backgroundColor = WPAC._Options.popupBackgroundColorLoading;\r\n\tvar textColor = WPAC._Options.popupTextColorLoading;\r\n\tif (type == \"error\") {\r\n\t\tbackgroundColor = WPAC._Options.popupBackgroundColorError;\r\n\t\ttextColor = WPAC._Options.popupTextColorError;\r\n\t} else if (type == \"success\") {\r\n\t\tbackgroundColor = WPAC._Options.popupBackgroundColorSuccess;\r\n\t\ttextColor = WPAC._Options.popupTextColorSuccess;\r\n\t}\r\n\t\r\n\tjQuery.blockUI({ \r\n\t\tmessage: message, \r\n\t\tfadeIn: WPAC._Options.popupFadeIn, \r\n\t\tfadeOut: WPAC._Options.popupFadeOut, \r\n\t\ttimeout:(type == \"loading\") ? 0 : WPAC._Options.popupTimeout,\r\n\t\tcenterY: false,\r\n\t\tcenterX: true,\r\n\t\tshowOverlay: (type == \"loading\" || type == \"loadingPreview\" ),\r\n\t\tcss: { \r\n\t\t\twidth: WPAC._Options.popupWidth + \"%\",\r\n\t\t\tleft: ((100-WPAC._Options.popupWidth)/2) + \"%\",\r\n\t\t\ttop: top + \"px\",\r\n\t\t\tborder: \"none\", \r\n\t\t\tpadding: WPAC._Options.popupPadding + \"px\", \r\n\t\t\tbackgroundColor: backgroundColor, \r\n\t\t\t\"-webkit-border-radius\": WPAC._Options.popupCornerRadius + \"px\",\r\n\t\t\t\"-moz-border-radius\": WPAC._Options.popupCornerRadius + \"px\",\r\n\t\t\t\"border-radius\": WPAC._Options.popupCornerRadius + \"px\",\r\n\t\t\topacity: WPAC._Options.popupOpacity/100, \r\n\t\t\tcolor: textColor,\r\n\t\t\ttextAlign: WPAC._Options.popupTextAlign,\r\n\t\t\tcursor: (type == \"loading\" || type == \"loadingPreview\" ) ? \"wait\" : \"default\",\r\n\t\t\t\"font-size\": WPAC._Options.popupTextFontSize\r\n\t\t},\r\n\t\toverlayCSS:  { \r\n\t\t\tbackgroundColor: \"#000\", \r\n\t\t\topacity: 0\r\n\t\t},\r\n\t\tbaseZ: WPAC._Options.popupZindex\r\n\t}); \r\n\t\r\n}\r\n\r\nWPAC._DebugErrorShown = false;\r\nWPAC._Debug = function(level, message) {\r\n\r\n\tif (!WPAC._Options.debug) return;\r\n\r\n\t// Fix console.log.apply for IE9\r\n\t// see http://stackoverflow.com/a/5539378/516472\r\n\tif (Function.prototype.call && Function.prototype.call.bind && typeof window[\"console\"] != \"undefined\" && console && typeof console.log == \"object\" && typeof window[\"console\"][level].apply === \"undefined\") {\r\n\t\tconsole[level] = Function.prototype.call.bind(console[level], console);\r\n\t}\r\n\r\n\tif (typeof window[\"console\"] === \"undefined\" || typeof window[\"console\"][level] === \"undefined\" || typeof window[\"console\"][level].apply === \"undefined\") {\r\n\t\tif (!WPAC._DebugErrorShown) alert(\"Unfortunately the console object is undefined or is not supported in your browser, debugging WP Ajaxify Comments is disabled! Please use Firebug, Google Chrome or Internet Explorer 9 or above with enabled Developer Tools (F12) for debugging WP Ajaxify Comments.\");\r\n\t\tWPAC._DebugErrorShown = true;\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar args = jQuery.merge([\"[WP Ajaxify Comments] \" + message], jQuery.makeArray(arguments).slice(2));\r\n\tconsole[level].apply(console, args);\r\n}\r\n\r\nWPAC._DebugSelector = function(elementType, selector, optional) {\r\n\tif (!WPAC._Options.debug) return;\r\n\r\n\tvar element = jQuery(selector);\r\n\tif (!element.length) {\r\n\t\tWPAC._Debug(optional ? \"info\" : \"error\", \"Search %s (selector: '%s')... Not found\", elementType, selector);\r\n\t} else {\r\n\t\tWPAC._Debug(\"info\", \"Search %s (selector: '%s')... Found: %o\", elementType, selector, element);\r\n\t}\r\n}\r\n\r\nWPAC._AddQueryParamStringToUrl = function(url, param, value) {\r\n\t// Get URL object.\r\n\tconst urlObject = new URL(url);\r\n\r\n\t// Get query params.\r\n\tconst queryParams = urlObject.searchParams;\r\n\r\n\t// Set query param.\r\n\tqueryParams.set(param, value);\r\n\r\n\t// Set query params.\r\n\turlObject.search = queryParams.toString();\r\n\r\n\t// Return URL.\r\n\treturn urlObject.toString();\r\n}\r\n\r\nWPAC._LoadFallbackUrl = function(fallbackUrl) {\r\n\r\n\tWPAC._ShowMessage(WPAC._Options.textReloadPage, \"loading\");\r\n\t\r\n\tvar url = WPAC._AddQueryParamStringToUrl(fallbackUrl, \"WPACRandom\", (new Date()).getTime());\r\n\tWPAC._Debug(\"info\", \"Something went wrong. Reloading page (URL: '%s')...\", url);\r\n\t\r\n\tvar reload = function() { location.href = url; };\r\n\tif (!WPAC._Options.debug) {\r\n\t\treload();\r\n\t} else {\r\n\t\tWPAC._Debug(\"info\", \"Sleep for 5s to enable analyzing debug messages...\");\r\n\t\twindow.setTimeout(reload, 5000);\r\n\t}\r\n}\r\n\r\nWPAC._ScrollToAnchor = function(anchor, updateHash, scrollComplete) {\r\n\tscrollComplete = scrollComplete || function() {};\r\n\tvar anchorElement = jQuery(anchor)\r\n\tif (anchorElement.length) {\r\n\t\tWPAC._Debug(\"info\", \"Scroll to anchor element %o (scroll speed: %s ms)...\", anchorElement, WPAC._Options.scrollSpeed);\r\n\t\tvar animateComplete = function() {\r\n\t\t\tif (updateHash) window.location.hash = anchor; \r\n\t\t\tscrollComplete();\r\n\t\t}\r\n\t\tvar scrollTargetTopOffset = anchorElement.offset().top\r\n\t\tif (jQuery(window).scrollTop() == scrollTargetTopOffset) {\r\n\t\t\tanimateComplete();\r\n\t\t} else {\r\n\t\t\tjQuery(\"html,body\").animate({scrollTop: scrollTargetTopOffset}, {\r\n\t\t\t\tduration: WPAC._Options.scrollSpeed,\r\n\t\t\t\tcomplete: animateComplete\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn true;\r\n\t} else {\r\n\t\tWPAC._Debug(\"error\", \"Anchor element not found (selector: '%s')\", anchor);\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nWPAC._UpdateUrl= function(url) {\r\n\tif (url.split(\"#\")[0] == window.location.href.split(\"#\")[0]) {\r\n\t\treturn;\r\n\t}\r\n\tif (window.history.replaceState) {\r\n\t\twindow.history.replaceState({}, window.document.title, url);\r\n\t} else {\r\n\t\tWPAC._Debug(\"info\", \"Browser does not support window.history.replaceState() to update the URL without reloading the page\", anchor);\r\n\t}\r\n}\r\n\r\nWPAC._ReplaceComments = function(data, commentUrl, useFallbackUrl, formData, formFocus, selectorCommentsContainer, selectorCommentForm, selectorRespondContainer, beforeSelectElements, beforeUpdateComments, afterUpdateComments) {\r\n\t\r\n\tvar fallbackUrl = useFallbackUrl ? WPAC._AddQueryParamStringToUrl(commentUrl, \"WPACFallback\", \"1\") : commentUrl;\r\n\t\r\n\tvar oldCommentsContainer = jQuery(selectorCommentsContainer);\r\n\tif (!oldCommentsContainer.length) {\r\n\t\tWPAC._Debug(\"error\", \"Comment container on current page not found (selector: '%s')\", selectorCommentsContainer);\r\n\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\treturn false;\r\n\t}\r\n\t// If length is greater than one, there may be greedy selectors.\r\n\tif (oldCommentsContainer.length > 1) {\r\n\t\tWPAC._Debug(\"error\", \"Comment form on requested page found multiple times (selector: '%s')\", oldCommentsContainer);\r\n\t\toldCommentsContainer = oldCommentsContainer.filter(function() {\r\n\t\t\treturn jQuery(this).children().length > 0 && !jQuery(this).is(\":header\");\r\n\t\t});\r\n\t}\r\n\t\r\n\tvar extractedBody = WPAC._ExtractBody(data);\r\n\tif (extractedBody === false) {\r\n\t\tWPAC._Debug(\"error\", \"Unsupported server response, unable to extract body (data: '%s')\", data);\r\n\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t// Call before select elements.\r\n\tif ( beforeSelectElements !== '' ) {\r\n\t\tconst beforeSelect = new Function( 'extractedBody', beforeSelectElements );\r\n\t\tbeforeSelect( extractedBody );\r\n\t}\r\n\t\r\n\tvar newCommentsContainer = extractedBody.find(selectorCommentsContainer);\r\n\tif (!newCommentsContainer.length) {\r\n\t\tWPAC._Debug(\"error\", \"Comment container on requested page not found (selector: '%s')\", selectorCommentsContainer);\r\n\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\treturn false;\r\n\t}\r\n\tif (newCommentsContainer.length > 1) {\r\n\t\tWPAC._Debug(\"error\", \"Comment form on requested page found multiple times (selector: '%s')\", newCommentsContainer);\r\n\t\tconsole.log( newCommentsContainer );\r\n\r\n\t\t// Find the first comment container that has children and is not a heading.\r\n\t\tnewCommentsContainer = newCommentsContainer.filter(function() {\r\n\t\t\treturn jQuery(this).children().length > 0 && !jQuery(this).is(\":header\");\r\n\t\t});\r\n\t}\r\n\r\n\t// Call before update comments.\r\n\tif ( '' !== beforeUpdateComments ) {\r\n\t\tconst beforeComments = new Function( 'extractedBody', 'commentUrl', beforeUpdateComments );\r\n\t\tbeforeComments( extractedBody, commentUrl );\r\n\t}\r\n\r\n\t// Update title\r\n\tvar extractedTitle = WPAC._ExtractTitle(data);\r\n\tif (extractedBody !== false) \r\n\t\t// Decode HTML entities (see http://stackoverflow.com/a/5796744)\r\n\t\tdocument.title = jQuery('<textarea />').html(extractedTitle).text(); \r\n\t\r\n\t// Update comments container\r\n\toldCommentsContainer.replaceWith(newCommentsContainer);\r\n\t\r\n\tif (WPAC._Options.commentsEnabled) {\r\n\t\r\n\t\tvar form = jQuery(selectorCommentForm);\r\n\t\tif (form.length) {\r\n\t\r\n\t\t\t// Replace comment form (for spam protection plugin compatibility) if comment form is not nested in comments container\r\n\t\t\t// If comment form is nested in comments container comment form has already been replaced\r\n\t\t\tif (!form.parents(selectorCommentsContainer).length) {\r\n\t\r\n\t\t\t\tWPAC._Debug(\"info\", \"Replace comment form...\");\r\n\t\t\t\tvar newCommentForm = extractedBody.find(selectorCommentForm);\r\n\t\t\t\tif (newCommentForm.length == 0) {\r\n\t\t\t\t\tWPAC._Debug(\"error\", \"Comment form on requested page not found (selector: '%s')\", selectorCommentForm);\r\n\t\t\t\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tform.replaceWith(newCommentForm);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} else {\r\n\t\r\n\t\t\tWPAC._Debug(\"info\", \"Try to re-inject comment form...\");\r\n\t\t\r\n\t\t\t// \"Re-inject\" comment form, if comment form was removed by updating the comments container; could happen \r\n\t\t\t// if theme support threaded/nested comments and form tag is not nested in comments container\r\n\t\t\t// -> Replace WordPress placeholder <div> (#wp-temp-form-div) with respond <div>\r\n\t\t\tvar wpTempFormDiv = jQuery(\"#wp-temp-form-div\");\r\n\t\t\tif (!wpTempFormDiv.length) {\r\n\t\t\t\tWPAC._Debug(\"error\", \"WordPress' #wp-temp-form-div container not found\", selectorRespondContainer);\r\n\t\t\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar newRespondContainer = extractedBody.find(selectorRespondContainer);\r\n\t\t\tif (!newRespondContainer.length) {\r\n\t\t\t\tWPAC._Debug(\"error\", \"Respond container on requested page not found (selector: '%s')\", selectorRespondContainer);\r\n\t\t\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\twpTempFormDiv.replaceWith(newRespondContainer);\r\n\t\r\n\t\t}\r\n\t\r\n\t\tif (formData) {\r\n\t\t\t// Re-inject saved form data\r\n\t\t\tjQuery.each(formData, function(key, value) {\r\n\t\t\t\tvar formElement = jQuery(\"[name='\"+value.name+\"']\", selectorCommentForm);\r\n\t\t\t\tif (formElement.length != 1 || formElement.val()) return;\r\n\t\t\t\tformElement.val(value.value);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (formFocus) {\r\n\t\t\t// Reset focus\r\n\t\t\tvar formElement = jQuery(\"[name='\"+formFocus+\"']\", selectorCommentForm);\r\n\t\t\tif (formElement) formElement.focus();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Call after update comments.\r\n\tif ( '' !== afterUpdateComments ) {\r\n\t\tconsole.log( afterUpdateComments );\r\n\t\tconst updateComments = new Function( 'extractedBody', 'commentUrl', afterUpdateComments );\r\n\t\tupdateComments( extractedBody, commentUrl );\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nWPAC._TestCrossDomainScripting = function(url) {\r\n\tif (url.indexOf(\"http\") != 0) return false;\r\n\tvar domain = window.location.protocol + \"//\" + window.location.host;\r\n\treturn (url.indexOf(domain) != 0);\r\n}\r\n\r\nWPAC._TestFallbackUrl = function(url) {\r\n\t// Get URL object.\r\n\tconst urlObject = new URL(url);\r\n\r\n\t// Get query params.\r\n\tconst queryParams = urlObject.searchParams;\r\n\tconst fallbackParam = queryParams.get('WPACFallback');\r\n\tconst randomParam = queryParams.get('WPACRandom');\r\n\r\n\treturn (fallbackParam && randomParam);\r\n}\r\n\r\nWPAC.AttachForm = function(options) {\r\n\r\n\t// Set default options\r\n\toptions = jQuery.extend({\r\n\t\tselectorCommentForm: WPAC._Options.selectorCommentForm,\r\n\t\tselectorCommentPagingLinks: WPAC._Options.selectorCommentPagingLinks,\r\n\t\tbeforeSelectElements: WPACCallbacks.beforeSelectElements,\r\n\t\tbeforeSubmitComment: WPACCallbacks.beforeSubmitComment,\r\n\t\tafterPostComment: WPACCallbacks.afterPostComment,\r\n\t\tselectorCommentsContainer: WPAC._Options.selectorCommentsContainer,\r\n\t\tselectorRespondContainer: WPAC._Options.selectorRespondContainer,\r\n\t\tbeforeUpdateComments: WPACCallbacks.beforeUpdateComments,\r\n\t\tafterUpdateComments: WPACCallbacks.afterUpdateComments,\r\n\t\tscrollToAnchor: !WPAC._Options.disableScrollToAnchor,\r\n\t\tupdateUrl: !WPAC._Options.disableUrlUpdate,\r\n\t\tselectorCommentLinks: WPAC._Options.selectorCommentLinks\r\n\t}, options || {});\t\r\n\r\n\tif (WPAC._Options.debug && WPAC._Options.commentsEnabled) {\r\n\t\tWPAC._Debug(\"info\", \"Attach form...\")\r\n\t\tWPAC._DebugSelector(\"comment form\", options.selectorCommentForm);\r\n\t\tWPAC._DebugSelector(\"comments container\",options.selectorCommentsContainer);\r\n\t\tWPAC._DebugSelector(\"respond container\", options.selectorRespondContainer)\r\n\t\tWPAC._DebugSelector(\"comment paging links\", options.selectorCommentPagingLinks, true);\r\n\t\tWPAC._DebugSelector(\"comment links\", options.selectorCommentLinks, true);\r\n\t}\r\n\r\n\t// Try before submit comment. Using new function is not ideal here, but safer than exec.\r\n\tif ( '' !== WPACCallbacks.beforeSelectElements ) {\r\n\t\tconst beforeSelect = new Function( 'dom', WPACCallbacks.beforeSelectElements );\r\n\t\tbeforeSelect( jQuery(document) );\r\n\t}\r\n\t\r\n\t// Get addHandler method\r\n\tif (jQuery(document).on) {\r\n\t\t// jQuery 1.7+\r\n\t\tvar addHandler = function(event, selector, handler) {\r\n\t\t\tjQuery(document).on(event, selector, handler)\r\n\t\t}\r\n\t} else if (jQuery(document).delegate) {\r\n\t\t// jQuery 1.4.3+\r\n\t\tvar addHandler = function(event, selector, handler) {\r\n\t\t\tjQuery(document).delegate(selector, event, handler)\r\n\t\t}\r\n\t} else {\r\n\t\t// jQuery 1.3+\r\n\t\tvar addHandler = function(event, selector, handler) {\r\n\t\t\tjQuery(selector).live(event, handler)\r\n\t\t}\r\n\t}\r\n\r\n\t// Handle paging link clicks\r\n\tvar pagingClickHandler = function(event) {\r\n\t\tvar href = jQuery(this).attr(\"href\");\r\n\t\tif (href) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tWPAC.LoadComments(href, {\r\n\t\t\t\tselectorCommentForm: options.selectorCommentForm,\r\n\t\t\t\tselectorCommentsContainer: options.selectorCommentsContainer,\r\n\t\t\t\tselectorRespondContainer: options.selectorRespondContainer,\r\n\t\t\t\tbeforeSelectElements: options.beforeSelectElements,\r\n\t\t\t\tbeforeUpdateComments: options.beforeUpdateComments,\r\n\t\t\t\tafterUpdateComments: options.afterUpdateComments\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\taddHandler(\"click\", options.selectorCommentPagingLinks, pagingClickHandler);\r\n\t\r\n\t// Handle comment link clicks\r\n\tvar linkClickHandler = function(event) {\r\n\t\tvar element = jQuery(this);\r\n\t\tif (element.is(options.selectorCommentPagingLinks)) return; // skip if paging link was clicked \r\n\t\tvar href = element.attr(\"href\");\r\n\t\tvar anchor = \"#\" + (new Uri(href)).anchor();\r\n\t\tif (jQuery(anchor).length > 0) {\r\n\t\t\tif (options.updateUrl) WPAC._UpdateUrl(href);\r\n\t\t\tWPAC._ScrollToAnchor(anchor, options.updateUrl);\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t};\r\n\taddHandler(\"click\", options.selectorCommentLinks, linkClickHandler);\r\n\t\r\n\tif (!WPAC._Options.commentsEnabled) return;\r\n\t\r\n\t// Handle form submit\r\n\tvar formSubmitHandler = function (event) {\r\n\t\tvar form = jQuery(this);\r\n\r\n\t\t// Try before submit comment. Using new function is not ideal here, but safer than exec.\r\n\t\tif ( WPACCallbacks.beforeSubmitComment !== '' ) {\r\n\t\t\tconst beforeSubmit = new Function( 'dom', WPACCallbacks.beforeSubmitComment );\r\n\t\t\tbeforeSubmit( jQuery(document) );\r\n\t\t}\r\n\r\n\t\tvar submitUrl = form.attr(\"action\");\r\n\r\n\t\t// Cancel AJAX request if cross-domain scripting is detected\r\n\t\tif (WPAC._TestCrossDomainScripting(submitUrl)) {\r\n\t\t\tif (WPAC._Options.debug && !form.data(\"submitCrossDomain\")) {\r\n\t\t\t\tWPAC._Debug(\"error\", \"Cross-domain scripting detected (submit url: '%s'), cancel AJAX request\", submitUrl);\r\n\t\t\t\tWPAC._Debug(\"info\", \"Sleep for 5s to enable analyzing debug messages...\");\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tform.data(\"submitCrossDomain\", true)\r\n\t\t\t\twindow.setTimeout(function() { jQuery('#submit', form).remove(); form.submit(); }, 5000);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// Stop default event handling\r\n\t\tevent.preventDefault();\r\n\t\t\r\n\t\t// Test if form is already submitting\r\n\t\tif (form.data(\"WPAC_SUBMITTING\")) {\r\n\t\t\tWPAC._Debug(\"info\", \"Cancel submit, form is already submitting (Form: %o)\", form);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tform.data(\"WPAC_SUBMITTING\", true);\r\n\r\n\t\t// Show loading info\r\n\t\tWPAC._ShowMessage(WPAC._Options.textPostComment, \"loading\");\r\n\r\n\t\tvar handleErrorResponse = function(data) {\r\n\r\n\t\t\tWPAC._Debug(\"info\", \"Comment has not been posted\");\r\n\t\t\tWPAC._Debug(\"info\", \"Try to extract error message (selector: '%s')...\", WPAC._Options.selectorErrorContainer);\r\n\t\t\t\r\n\t\t\t// Extract error message\r\n\t\t\tvar extractedBody = WPAC._ExtractBody(data);\r\n\t\t\tif (extractedBody !== false) {\r\n\t\t\t\tvar errorMessage = extractedBody.find(WPAC._Options.selectorErrorContainer);\r\n\t\t\t\tif (errorMessage.length) {\r\n\t\t\t\t\terrorMessage = errorMessage.html();\r\n\t\t\t\t\tWPAC._Debug(\"info\", \"Error message '%s' successfully extracted\", errorMessage);\r\n\t\t\t\t\tWPAC._ShowMessage(errorMessage, \"error\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tWPAC._Debug(\"error\", \"Error message could not be extracted, use error message '%s'.\", WPAC._Options.textUnknownError);\r\n\t\t\tWPAC._ShowMessage(WPAC._Options.textUnknownError, \"error\");\r\n\t\t}\r\n\t\t\r\n\t\tvar request = jQuery.ajax({\r\n\t\t\turl: submitUrl,\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: form.serialize(),\r\n\t\t\tbeforeSend: function(xhr){ xhr.setRequestHeader('X-WPAC-REQUEST', '1'); },\r\n\t\t\tcomplete: function(xhr, textStatus) { form.removeData(\"WPAC_SUBMITTING\", true); },\r\n\t\t\tsuccess: function (data) {\r\n\r\n\t\t\t\t// Test error state (WordPress >=4.1 does not return 500 status code if posting comment failed)\r\n\t\t\t\tif (request.getResponseHeader(\"X-WPAC-ERROR\")) {\r\n\t\t\t\t\tWPAC._Debug(\"info\", \"Found error state X-WPAC-ERROR header.\", commentUrl);\r\n\t\t\t\t\thandleErrorResponse(data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tWPAC._Debug(\"info\", \"Comment has been posted\");\r\n\r\n\t\t\t\t// Get info from response header\r\n\t\t\t\tvar commentUrl = request.getResponseHeader(\"X-WPAC-URL\");\r\n\t\t\t\tWPAC._Debug(\"info\", \"Found comment URL '%s' in X-WPAC-URL header.\", commentUrl);\r\n\t\t\t\tvar unapproved = request.getResponseHeader(\"X-WPAC-UNAPPROVED\");\r\n\t\t\t\tWPAC._Debug(\"info\", \"Found unapproved state '%s' in X-WPAC-UNAPPROVED\", unapproved);\r\n\r\n\t\t\t\t// Try afterPostComment submit comment. Using new function is not ideal here, but safer than exec.\r\n\t\t\t\tif ( WPACCallbacks.afterPostComment !== '' ) {\r\n\t\t\t\t\tconst afterComment = new Function( 'commentUrl', 'unapproved', afterPostComment);\r\n    \t\t\t\tafterComment( commentUrl, unapproved == '1');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Show success message\r\n\t\t\t\tWPAC._ShowMessage(unapproved == '1' ? WPAC._Options.textPostedUnapproved : WPAC._Options.textPosted, \"success\");\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Sunshine Confetti Plugin integration.\r\n\t\t\t\t *\r\n\t\t\t\t * @since 3.0.0\r\n\t\t\t\t *\r\n\t\t\t\t * @see https://wordpress.org/plugins/confetti/\r\n\t\t\t\t */\r\n\t\t\t\tif ( typeof window.wps_launch_confetti_cannon !== 'undefined' ) {\r\n\t\t\t\t\twindow.wps_launch_confetti_cannon();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Replace comments (and return if replacing failed)\r\n\t\t\t\tif (!WPAC._ReplaceComments(data, commentUrl, false, {}, \"\", options.selectorCommentsContainer, options.selectorCommentForm, options.selectorRespondContainer, \r\n\t\t\t\t\toptions.beforeSelectElements, options.beforeUpdateComments, options.afterUpdateComments)) return;\r\n\t\t\t\t\r\n\t\t\t\t// Smooth scroll to comment url and update browser url\r\n\t\t\t\tif (commentUrl) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif (options.updateUrl)\r\n\t\t\t\t\t\tWPAC._UpdateUrl(commentUrl);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (options.scrollToAnchor) {\r\n\t\t\t\t\t\tvar anchor = commentUrl.indexOf(\"#\") >= 0 ? commentUrl.substr(commentUrl.indexOf(\"#\")) : null;\r\n\t\t\t\t\t\tif (anchor) {\r\n\t\t\t\t\t\t\tWPAC._Debug(\"info\", \"Anchor '%s' extracted from comment URL '%s'\", anchor, commentUrl);\r\n\t\t\t\t\t\t\tWPAC._ScrollToAnchor(anchor, options.updateUrl);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\terror: function (jqXhr, textStatus, errorThrown) {\r\n\r\n\t\t\t\t// Test if loading comment url failed (due to cross site scripting error)\r\n\t\t\t\tif (jqXhr.status === 0 && jqXhr.responseText === \"\") {\r\n\t\t\t\t\tWPAC._Debug(\"error\", \"Comment seems to be posted, but loading comment update failed.\");\r\n\t\t\t\t\tWPAC._LoadFallbackUrl(WPAC._AddQueryParamStringToUrl(window.location.href, \"WPACFallback\", \"1\"));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\thandleErrorResponse(jqXhr.responseText);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\taddHandler(\"submit\", options.selectorCommentForm, formSubmitHandler)\r\n}\r\n\r\nWPAC._Initialized = false;\r\nWPAC.Init = function() {\r\n\r\n\t// Test if plugin already has been initialized\r\n\tif (WPAC._Initialized) {\r\n\t\tWPAC._Debug(\"info\", \"Abort initialization (plugin already initialized)\");\r\n\t\treturn false;\r\n\t}\r\n\tWPAC._Initialized = true;\r\n\t\r\n\t// Assert that environment is set up correctly\r\n\tif (!WPAC._Options || !WPACCallbacks) {\r\n\t\tWPAC._Debug(\"error\", \"Something unexpected happened, initialization failed. Please try to reinstall the plugin.\");\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Debug infos\r\n\tWPAC._Debug(\"info\", \"Initializing version %s\", WPAC._Options.version);\r\n\r\n\t// Debug infos\r\n\tif (WPAC._Options.debug) {\r\n\t\tif (!jQuery || !jQuery.fn || !jQuery.fn.jquery) {\r\n\t\t\tWPAC._Debug(\"error\", \"jQuery not found, abort initialization. Please try to reinstall the plugin.\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tWPAC._Debug(\"info\", \"Found jQuery %s\", jQuery.fn.jquery);\r\n\t\tif (!jQuery.blockUI || !jQuery.blockUI.version) {\r\n\t\t\tWPAC._Debug(\"error\", \"jQuery blockUI not found, abort initialization. Please try to reinstall the plugin.\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tWPAC._Debug(\"info\", \"Found jQuery blockUI %s\", jQuery.blockUI.version);\r\n\t\tif (!jQuery.idleTimer) {\r\n\t\t\tWPAC._Debug(\"error\", \"jQuery Idle Timer plugin not found, abort initialization. Please try to reinstall the plugin.\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tWPAC._Debug(\"info\", \"Found jQuery Idle Timer plugin\");\r\n\t}\r\n\r\n\tif (WPAC._Options.selectorPostContainer) {\r\n\t\tWPAC._Debug(\"info\", \"Multiple comment form support enabled (selector: '%s')\", WPAC._Options.selectorPostContainer);\r\n\t\tjQuery(WPAC._Options.selectorPostContainer).each(function(i,e) {\r\n\t\t\tvar id = jQuery(e).attr(\"id\");\r\n\t\t\tif (!id) {\r\n\t\t\t\tWPAC._Debug(\"info\", \"Skip post container element %o (ID not defined)\", e);\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tWPAC.AttachForm({\r\n\t\t\t\tselectorCommentForm: \"#\" + id + \" \" + WPAC._Options.selectorCommentForm,\r\n\t\t\t\tselectorCommentPagingLinks: \"#\" + id + \" \" + WPAC._Options.selectorCommentPagingLinks,\r\n\t\t\t\tselectorCommentsContainer: \"#\" + id + \" \" + WPAC._Options.selectorCommentsContainer,\r\n\t\t\t\tselectorRespondContainer: \"#\" + id + \" \" + WPAC._Options.selectorRespondContainer\r\n\t\t\t});\t\r\n\t\t});\r\n\t} else {\r\n\t\tWPAC.AttachForm();\r\n\t}\r\n\r\n\t// Set up loading preview handlers.\r\n\tjQuery( '#wp-admin-bar-wpac-menu-helper-preview-overlay-loading a' ).on( 'click', function( e ) {\r\n\t\te.preventDefault();\r\n\t\tWPAC._ShowMessage( \"This is the loading preview...\", \"loadingPreview\" );\r\n\t} );\r\n\r\n\t// Set up success preview handlers.\r\n\tjQuery( '#wp-admin-bar-wpac-menu-helper-preview-overlay-success a' ).on( 'click', function( e ) {\r\n\t\te.preventDefault();\r\n\t\tWPAC._ShowMessage( \"This is a success message\", \"success\" );\r\n\t} );\r\n\r\n\t// Set up error preview handlers.\r\n\tjQuery( '#wp-admin-bar-wpac-menu-helper-preview-overlay-error a' ).on( 'click', function( e ) {\r\n\t\te.preventDefault();\r\n\t\tWPAC._ShowMessage( \"This is an error message\", \"error\" );\r\n\t} );\r\n\t\r\n\t// Set up idle timer\r\n\tif (WPAC._Options.commentsEnabled && WPAC._Options.autoUpdateIdleTime > 0) {\r\n\t\tWPAC._Debug(\"info\", \"Auto updating comments enabled (idle time: %s)\", WPAC._Options.autoUpdateIdleTime);\r\n\t\tWPAC._InitIdleTimer();\r\n\t}\r\n\t\r\n\tWPAC._Debug(\"info\", \"Initialization completed\");\r\n\r\n\treturn true;\r\n}\r\n\r\nWPAC._OnIdle = function() {\r\n\tWPAC.RefreshComments({ success: WPAC._InitIdleTimer, scrollToAnchor: false});\r\n};\r\n\r\nWPAC._InitIdleTimer = function() {\r\n\tif (WPAC._TestFallbackUrl(location.href)) {\r\n\t\tWPAC._Debug(\"error\", \"Fallback URL was detected (url: '%s'), cancel init idle timer\", location.href);\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tjQuery(document).idleTimer(\"destroy\");\r\n\tjQuery(document).idleTimer(WPAC._Options.autoUpdateIdleTime);\r\n\tjQuery(document).on(\"idle.idleTimer\", WPAC._OnIdle);\r\n}\r\n\r\nWPAC.RefreshComments = function(options) {\r\n\tvar url = location.href;\r\n\t\r\n\tif (WPAC._TestFallbackUrl(location.href)) {\r\n\t\tWPAC._Debug(\"error\", \"Fallback URL was detected (url: '%s'), cancel AJAX request\", url);\r\n\t\treturn false;   \r\n\t}\r\n\t\r\n\treturn WPAC.LoadComments(url, options)\r\n}\r\n\r\nWPAC.LoadComments = function(url, options) {\r\n\r\n\t// Cancel AJAX request if cross-domain scripting is detected\r\n\tif (WPAC._TestCrossDomainScripting(url)) {\r\n\t\tWPAC._Debug(\"error\", \"Cross-domain scripting detected (url: '%s'), cancel AJAX request\", url);\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Convert boolean parameter (used in version <0.14.0)\r\n\tif (typeof(options) == \"boolean\")\r\n\t\toptions = {scrollToAnchor: options}\r\n\r\n\t// Set default options\r\n\toptions = jQuery.extend({\r\n\t\tscrollToAnchor: !WPAC._Options.disableScrollToAnchor,\r\n\t\tshowLoadingInfo: true,\r\n\t\tupdateUrl: !WPAC._Options.disableUrlUpdate,\r\n\t\tsuccess: function() {},\r\n\t\tselectorCommentForm: WPAC._Options.selectorCommentForm,\r\n\t\tselectorCommentsContainer: WPAC._Options.selectorCommentsContainer,\r\n\t\tselectorRespondContainer: WPAC._Options.selectorRespondContainer,\r\n\t\tdisableCache: WPAC._Options.disableCache,\r\n\t\tbeforeSelectElements: WPAC._Callbacks.beforeSelectElements, \r\n\t\tbeforeUpdateComments: WPAC._Callbacks.beforeUpdateComments,\r\n\t\tafterUpdateComments: WPAC._Callbacks.afterUpdateComments,\r\n\t}, options || {});\t\r\n\t\r\n\t// Save form data and focus\r\n\tvar formData = jQuery(options.selectorCommentForm).serializeArray();\r\n\tvar formFocus = (document.activeElement) ? jQuery(\"[name='\"+document.activeElement.name+\"']\", options.selectorCommentForm).attr(\"name\") : \"\";\r\n\t\r\n\t// Show loading info\r\n\tif (options.showLoadingInfo)\r\n\t\tWPAC._ShowMessage(WPAC._Options.textRefreshComments, \"loading\");\r\n\r\n\tif (options.disableCache) \r\n\t\turl = WPAC._AddQueryParamStringToUrl(url, \"WPACRandom\", (new Date()).getTime());\r\n\t\t\r\n\tvar request = jQuery.ajax({\r\n\t\turl: url,\r\n\t\ttype: \"GET\",\r\n\t\tbeforeSend: function(xhr){ xhr.setRequestHeader(\"X-WPAC-REQUEST\", \"1\"); },\r\n\t\tsuccess: function (data) {\r\n\r\n\t\t\t// Replace comments (and return if replacing failed)\r\n\t\t\tif (!WPAC._ReplaceComments(data, url, true, formData, formFocus, options.selectorCommentsContainer, options.selectorCommentForm, \r\n\t\t\t\toptions.selectorRespondContainer, options.beforeSelectElements, options.beforeUpdateComments, options.afterUpdateComments)) return;\r\n\t\t\t\r\n\t\t\tif (options.updateUrl) WPAC._UpdateUrl(url);\r\n\r\n\t\t\t// Scroll to anchor\r\n\t\t\tvar waitForScrollToAnchor = false;\r\n\t\t\tif (options.scrollToAnchor) {\r\n\t\t\t\tvar anchor = url.indexOf(\"#\") >= 0 ? url.substr(url.indexOf(\"#\")) : null;\r\n\t\t\t\tif (anchor) {\r\n\t\t\t\t\tWPAC._Debug(\"info\", \"Anchor '%s' extracted from url\", anchor);\r\n\t\t\t\t\tif (WPAC._ScrollToAnchor(anchor, options.updateUrl, function() { options.success(); } )) {\r\n\t\t\t\t\t\twaitForScrollToAnchor = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Unblock UI\r\n\t\t\tjQuery.unblockUI();\r\n\t\t\t\r\n\t\t\tif (!waitForScrollToAnchor) options.success();\r\n\t\t},\r\n\t\terror: function() {\r\n\t\t\tWPAC._LoadFallbackUrl(WPAC._AddQueryParamStringToUrl(window.location.href, \"WPACFallback\", \"1\"))\r\n\t\t} \r\n\t\t\r\n\t});\r\n\t\r\n\treturn true;\r\n}\r\n\r\njQuery(function() {\r\n\tvar initSuccesful = WPAC.Init();\r\n\tif (WPAC._Options.loadCommentsAsync) {\r\n\t\tif (!initSuccesful) {\r\n\t\t\tWPAC._LoadFallbackUrl(WPAC._AddQueryParamStringToUrl(window.location.href, \"WPACFallback\", \"1\"))\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar asyncLoadTrigger = WPAC._Options.asyncLoadTrigger;\r\n\t\tWPAC._Debug(\"info\", \"Loading comments asynchronously with secondary AJAX request (trigger: '%s')\", asyncLoadTrigger);\r\n\t\t\r\n\t\tif (window.location.hash) {\r\n\t\t\tvar regex = /^#comment-[0-9]+$/;\r\n\t\t\tif (regex.test(window.location.hash)) {\r\n\t\t\t\tWPAC._Debug(\"info\", \"Comment anchor in URL detected, force loading comments on DomReady (hash: '%s')\", window.location.hash);\r\n\t\t\t\tasyncLoadTrigger = \"DomReady\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (asyncLoadTrigger == \"Viewport\") {\r\n\t\t\tjQuery(WPAC._Options.selectorCommentsContainer).waypoint(function(direction) {\r\n\t\t\t\tthis.destroy();\r\n\t\t\t\tWPAC.RefreshComments();\r\n\t\t\t}, { offset: \"100%\" });\r\n\t\t} else if (asyncLoadTrigger == \"DomReady\") {\r\n\t\t\tWPAC.RefreshComments({scrollToAnchor: true}); // force scroll to anchor\r\n\t\t}\r\n\t} \r\n});\r\n\r\nfunction wpac_init() {\r\n\tWPAC._Debug(\"info\", \"wpac_init() is deprecated, please use WPAC.Init()\");\r\n\tWPAC.Init();\r\n}"],"names":["WPAC","_Options","_BodyRegex","RegExp","_ExtractBody","html","jQuery","exec","e","_TitleRegex","_ExtractTitle","_ShowMessage","message","type","top","popupMarginTop","outerHeight","backgroundColor","popupBackgroundColorLoading","textColor","popupTextColorLoading","popupBackgroundColorError","popupTextColorError","popupBackgroundColorSuccess","popupTextColorSuccess","blockUI","fadeIn","popupFadeIn","fadeOut","popupFadeOut","timeout","popupTimeout","centerY","centerX","showOverlay","css","width","popupWidth","left","border","padding","popupPadding","popupCornerRadius","opacity","popupOpacity","color","textAlign","popupTextAlign","cursor","popupTextFontSize","overlayCSS","baseZ","popupZindex","_DebugErrorShown","_Debug","level","debug","Function","prototype","call","bind","window","console","_typeof","log","apply","alert","args","merge","makeArray","arguments","slice","_DebugSelector","elementType","selector","optional","element","length","_AddQueryParamStringToUrl","url","param","value","urlObject","URL","queryParams","searchParams","set","search","toString","_LoadFallbackUrl","fallbackUrl","textReloadPage","Date","getTime","reload","location","href","setTimeout","_ScrollToAnchor","anchor","updateHash","scrollComplete","anchorElement","scrollSpeed","animateComplete","hash","scrollTargetTopOffset","offset","scrollTop","animate","duration","complete","_UpdateUrl","split","history","replaceState","document","title","_ReplaceComments","data","commentUrl","useFallbackUrl","formData","formFocus","selectorCommentsContainer","selectorCommentForm","selectorRespondContainer","beforeSelectElements","beforeUpdateComments","afterUpdateComments","oldCommentsContainer","filter","children","is","extractedBody","beforeSelect","newCommentsContainer","find","beforeComments","extractedTitle","text","replaceWith","commentsEnabled","form","parents","newCommentForm","wpTempFormDiv","newRespondContainer","each","key","formElement","name","val","focus","updateComments","_TestCrossDomainScripting","indexOf","domain","protocol","host","_TestFallbackUrl","fallbackParam","get","randomParam","AttachForm","options","extend","selectorCommentPagingLinks","WPACCallbacks","beforeSubmitComment","afterPostComment","scrollToAnchor","disableScrollToAnchor","updateUrl","disableUrlUpdate","selectorCommentLinks","on","addHandler","event","handler","delegate","live","pagingClickHandler","attr","preventDefault","LoadComments","linkClickHandler","Uri","formSubmitHandler","beforeSubmit","submitUrl","remove","submit","textPostComment","handleErrorResponse","selectorErrorContainer","errorMessage","textUnknownError","request","ajax","serialize","beforeSend","xhr","setRequestHeader","textStatus","removeData","success","getResponseHeader","unapproved","afterComment","textPostedUnapproved","textPosted","wps_launch_confetti_cannon","substr","error","jqXhr","errorThrown","status","responseText","_Initialized","Init","version","fn","jquery","idleTimer","selectorPostContainer","i","id","autoUpdateIdleTime","_InitIdleTimer","_OnIdle","RefreshComments","showLoadingInfo","disableCache","_Callbacks","serializeArray","activeElement","textRefreshComments","waitForScrollToAnchor","unblockUI","initSuccesful","loadCommentsAsync","asyncLoadTrigger","regex","test","waypoint","direction","destroy","wpac_init"],"sourceRoot":""}