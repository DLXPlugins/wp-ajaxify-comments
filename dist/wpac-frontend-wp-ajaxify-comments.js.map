{"version":3,"file":"wpac-frontend-wp-ajaxify-comments.js","mappings":"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","sources":["webpack://wp-ajaxify-comments/./src/js/frontend/wp-ajaxify-comments.js"],"sourcesContent":["WPAC._Options = WPAC._Options || {}; \r\n\r\nWPAC._BodyRegex = new RegExp(\"<body[^>]*>((.|\\n|\\r)*)</body>\", \"i\");\r\nWPAC._ExtractBody = function(html) {\r\n\ttry {\r\n\t\treturn jQuery(\"<div>\"+WPAC._BodyRegex.exec(html)[1]+\"</div>\");\r\n\t} catch (e) {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nWPAC._TitleRegex = new RegExp(\"<title[^>]*>(.*?)<\\\\/title>\", \"im\");\r\nWPAC._ExtractTitle = function(html) {\r\n\ttry {\r\n\t\treturn WPAC._TitleRegex.exec(html)[1];\r\n\t} catch (e) {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nWPAC._ShowMessage = function (message, type) {\r\n\r\n\tvar top = WPAC._Options.popupMarginTop + (jQuery(\"#wpadminbar\").outerHeight() || 0);\r\n\r\n\tvar backgroundColor = WPAC._Options.popupBackgroundColorLoading;\r\n\tvar textColor = WPAC._Options.popupTextColorLoading;\r\n\tif (type == \"error\") {\r\n\t\tbackgroundColor = WPAC._Options.popupBackgroundColorError;\r\n\t\ttextColor = WPAC._Options.popupTextColorError;\r\n\t} else if (type == \"success\") {\r\n\t\tbackgroundColor = WPAC._Options.popupBackgroundColorSuccess;\r\n\t\ttextColor = WPAC._Options.popupTextColorSuccess;\r\n\t}\r\n\t\r\n\tjQuery.blockUI({ \r\n\t\tblockMsgClass: \"wpac-overlay\",\r\n\t\tmessage: message, \r\n\t\tfadeIn: WPAC._Options.popupFadeIn, \r\n\t\tfadeOut: WPAC._Options.popupFadeOut, \r\n\t\ttimeout:(type == \"loading\") ? 0 : WPAC._Options.popupTimeout,\r\n\t\tcenterY: false,\r\n\t\tcenterX: true,\r\n\t\tshowOverlay: (type == \"loading\" || type == \"loadingPreview\" ),\r\n\t\tcss: { \r\n\t\t\twidth: WPAC._Options.popupWidth + \"%\",\r\n\t\t\tleft: ((100-WPAC._Options.popupWidth)/2) + \"%\",\r\n\t\t\ttop: top + \"px\",\r\n\t\t\tborder: \"none\", \r\n\t\t\tpadding: WPAC._Options.popupPadding + \"px\", \r\n\t\t\tbackgroundColor: backgroundColor, \r\n\t\t\t\"-webkit-border-radius\": WPAC._Options.popupCornerRadius + \"px\",\r\n\t\t\t\"-moz-border-radius\": WPAC._Options.popupCornerRadius + \"px\",\r\n\t\t\t\"border-radius\": WPAC._Options.popupCornerRadius + \"px\",\r\n\t\t\topacity: WPAC._Options.popupOpacity/100, \r\n\t\t\tcolor: textColor,\r\n\t\t\ttextAlign: WPAC._Options.popupTextAlign,\r\n\t\t\tcursor: (type == \"loading\" || type == \"loadingPreview\" ) ? \"wait\" : \"default\",\r\n\t\t\t\"font-size\": WPAC._Options.popupTextFontSize\r\n\t\t},\r\n\t\toverlayCSS:  { \r\n\t\t\tbackgroundColor: \"#000\", \r\n\t\t\topacity: 0\r\n\t\t},\r\n\t\tbaseZ: WPAC._Options.popupZindex\r\n\t}); \r\n\t\r\n}\r\n\r\nWPAC._DebugErrorShown = false;\r\nWPAC._Debug = function(level, message) {\r\n\r\n\tif (!WPAC._Options.debug) return;\r\n\r\n\t// Fix console.log.apply for IE9\r\n\t// see http://stackoverflow.com/a/5539378/516472\r\n\tif (Function.prototype.call && Function.prototype.call.bind && typeof window[\"console\"] != \"undefined\" && console && typeof console.log == \"object\" && typeof window[\"console\"][level].apply === \"undefined\") {\r\n\t\tconsole[level] = Function.prototype.call.bind(console[level], console);\r\n\t}\r\n\r\n\tif (typeof window[\"console\"] === \"undefined\" || typeof window[\"console\"][level] === \"undefined\" || typeof window[\"console\"][level].apply === \"undefined\") {\r\n\t\tif (!WPAC._DebugErrorShown) alert(\"Unfortunately the console object is undefined or is not supported in your browser, debugging WP Ajaxify Comments is disabled! Please use Firebug, Google Chrome or Internet Explorer 9 or above with enabled Developer Tools (F12) for debugging WP Ajaxify Comments.\");\r\n\t\tWPAC._DebugErrorShown = true;\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar args = jQuery.merge([\"[WP Ajaxify Comments] \" + message], jQuery.makeArray(arguments).slice(2));\r\n\tconsole[level].apply(console, args);\r\n}\r\n\r\nWPAC._DebugSelector = function(elementType, selector, optional) {\r\n\tif (!WPAC._Options.debug) return;\r\n\r\n\tvar element = jQuery(selector);\r\n\tif (!element.length) {\r\n\t\tWPAC._Debug(optional ? \"info\" : \"error\", \"Search %s (selector: '%s')... Not found\", elementType, selector);\r\n\t} else {\r\n\t\tWPAC._Debug(\"info\", \"Search %s (selector: '%s')... Found: %o\", elementType, selector, element);\r\n\t}\r\n}\r\n\r\nWPAC._AddQueryParamStringToUrl = function(url, param, value) {\r\n\t// Get URL object.\r\n\tconst urlObject = new URL(url);\r\n\r\n\t// Get query params.\r\n\tconst queryParams = urlObject.searchParams;\r\n\r\n\t// Set query param.\r\n\tqueryParams.set(param, value);\r\n\r\n\t// Set query params.\r\n\turlObject.search = queryParams.toString();\r\n\r\n\t// Return URL.\r\n\treturn urlObject.toString();\r\n}\r\n\r\nWPAC._LoadFallbackUrl = function(fallbackUrl) {\r\n\r\n\tWPAC._ShowMessage(WPAC._Options.textReloadPage, \"loading\");\r\n\t\r\n\tvar url = WPAC._AddQueryParamStringToUrl(fallbackUrl, \"WPACRandom\", (new Date()).getTime());\r\n\tWPAC._Debug(\"info\", \"Something went wrong. Reloading page (URL: '%s')...\", url);\r\n\t\r\n\tvar reload = function() { location.href = url; };\r\n\tif (!WPAC._Options.debug) {\r\n\t\treload();\r\n\t} else {\r\n\t\tWPAC._Debug(\"info\", \"Sleep for 5s to enable analyzing debug messages...\");\r\n\t\twindow.setTimeout(reload, 5000);\r\n\t}\r\n}\r\n\r\nWPAC._ScrollToAnchor = function(anchor, updateHash, scrollComplete) {\r\n\tscrollComplete = scrollComplete || function() {};\r\n\tvar anchorElement = jQuery(anchor)\r\n\tif (anchorElement.length) {\r\n\t\tWPAC._Debug(\"info\", \"Scroll to anchor element %o (scroll speed: %s ms)...\", anchorElement, WPAC._Options.scrollSpeed);\r\n\t\tvar animateComplete = function() {\r\n\t\t\tif (updateHash) window.location.hash = anchor; \r\n\t\t\tscrollComplete();\r\n\t\t}\r\n\t\tvar scrollTargetTopOffset = anchorElement.offset().top\r\n\t\tif (jQuery(window).scrollTop() == scrollTargetTopOffset) {\r\n\t\t\tanimateComplete();\r\n\t\t} else {\r\n\t\t\tjQuery(\"html,body\").animate({scrollTop: scrollTargetTopOffset}, {\r\n\t\t\t\tduration: WPAC._Options.scrollSpeed,\r\n\t\t\t\tcomplete: animateComplete\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn true;\r\n\t} else {\r\n\t\tWPAC._Debug(\"error\", \"Anchor element not found (selector: '%s')\", anchor);\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nWPAC._UpdateUrl= function(url) {\r\n\tif (url.split(\"#\")[0] == window.location.href.split(\"#\")[0]) {\r\n\t\treturn;\r\n\t}\r\n\tif (window.history.replaceState) {\r\n\t\twindow.history.replaceState({}, window.document.title, url);\r\n\t} else {\r\n\t\tWPAC._Debug(\"info\", \"Browser does not support window.history.replaceState() to update the URL without reloading the page\", anchor);\r\n\t}\r\n}\r\n\r\nWPAC._ReplaceComments = function(data, commentUrl, useFallbackUrl, formData, formFocus, selectorCommentsContainer, selectorCommentForm, selectorRespondContainer, beforeSelectElements, beforeUpdateComments, afterUpdateComments) {\r\n\t\r\n\tvar fallbackUrl = useFallbackUrl ? WPAC._AddQueryParamStringToUrl(commentUrl, \"WPACFallback\", \"1\") : commentUrl;\r\n\t\r\n\tvar oldCommentsContainer = jQuery(selectorCommentsContainer);\r\n\tif (!oldCommentsContainer.length) {\r\n\t\tWPAC._Debug(\"error\", \"Comment container on current page not found (selector: '%s')\", selectorCommentsContainer);\r\n\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\treturn false;\r\n\t}\r\n\t// If length is greater than one, there may be greedy selectors.\r\n\tif (oldCommentsContainer.length > 1) {\r\n\t\tWPAC._Debug(\"error\", \"Comment form on requested page found multiple times (selector: '%s')\", oldCommentsContainer);\r\n\t\toldCommentsContainer = oldCommentsContainer.filter(function() {\r\n\t\t\treturn jQuery(this).children().length > 0 && !jQuery(this).is(\":header\");\r\n\t\t});\r\n\t}\r\n\t\r\n\tvar extractedBody = WPAC._ExtractBody(data);\r\n\tif (extractedBody === false) {\r\n\t\tWPAC._Debug(\"error\", \"Unsupported server response, unable to extract body (data: '%s')\", data);\r\n\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t// Call before select elements.\r\n\tif ( beforeSelectElements !== '' ) {\r\n\t\tconst beforeSelect = new Function( 'extractedBody', beforeSelectElements );\r\n\t\tbeforeSelect( extractedBody );\r\n\r\n\t\t// Set up custom event.\r\n\t\tconst beforeSelectEvent = new CustomEvent( 'wpacBeforeSelectElements', { detail: { extractedBody: extractedBody } } );\r\n\t\tdocument.dispatchEvent( beforeSelectEvent );\r\n\t}\r\n\t\r\n\tvar newCommentsContainer = extractedBody.find(selectorCommentsContainer);\r\n\tif (!newCommentsContainer.length) {\r\n\t\tWPAC._Debug(\"error\", \"Comment container on requested page not found (selector: '%s')\", selectorCommentsContainer);\r\n\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\treturn false;\r\n\t}\r\n\tif (newCommentsContainer.length > 1) {\r\n\t\tWPAC._Debug(\"error\", \"Comment form on requested page found multiple times (selector: '%s')\", newCommentsContainer);\r\n\r\n\t\t// Find the first comment container that has children and is not a heading.\r\n\t\tnewCommentsContainer = newCommentsContainer.filter(function() {\r\n\t\t\treturn jQuery(this).children().length > 0 && !jQuery(this).is(\":header\");\r\n\t\t});\r\n\t}\r\n\r\n\t// Call before update comments.\r\n\tif ( '' !== beforeUpdateComments ) {\r\n\t\tconst beforeComments = new Function( 'extractedBody', 'commentUrl', beforeUpdateComments );\r\n\t\tbeforeComments( extractedBody, commentUrl );\r\n\r\n\t\t// Set up native event handler.\r\n\t\tconst beforeCommentsEvent = new CustomEvent( 'wpacBeforeUpdateComments', { detail: { newDom: extractedBody, commentUrl } } );\r\n\t\tdocument.dispatchEvent( beforeCommentsEvent );\r\n\t}\r\n\r\n\t// Update title\r\n\tvar extractedTitle = WPAC._ExtractTitle(data);\r\n\tif (extractedBody !== false) \r\n\t\t// Decode HTML entities (see http://stackoverflow.com/a/5796744)\r\n\t\tdocument.title = jQuery('<textarea />').html(extractedTitle).text(); \r\n\t\r\n\t// Update comments container\r\n\toldCommentsContainer.replaceWith(newCommentsContainer);\r\n\t\r\n\tif (WPAC._Options.commentsEnabled) {\r\n\t\r\n\t\tvar form = jQuery(selectorCommentForm);\r\n\t\tif (form.length) {\r\n\t\r\n\t\t\t// Replace comment form (for spam protection plugin compatibility) if comment form is not nested in comments container\r\n\t\t\t// If comment form is nested in comments container comment form has already been replaced\r\n\t\t\tif (!form.parents(selectorCommentsContainer).length) {\r\n\t\r\n\t\t\t\tWPAC._Debug(\"info\", \"Replace comment form...\");\r\n\t\t\t\tvar newCommentForm = extractedBody.find(selectorCommentForm);\r\n\t\t\t\tif (newCommentForm.length == 0) {\r\n\t\t\t\t\tWPAC._Debug(\"error\", \"Comment form on requested page not found (selector: '%s')\", selectorCommentForm);\r\n\t\t\t\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tform.replaceWith(newCommentForm);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} else {\r\n\t\r\n\t\t\tWPAC._Debug(\"info\", \"Try to re-inject comment form...\");\r\n\t\t\r\n\t\t\t// \"Re-inject\" comment form, if comment form was removed by updating the comments container; could happen \r\n\t\t\t// if theme support threaded/nested comments and form tag is not nested in comments container\r\n\t\t\t// -> Replace WordPress placeholder <div> (#wp-temp-form-div) with respond <div>\r\n\t\t\tvar wpTempFormDiv = jQuery(\"#wp-temp-form-div\");\r\n\t\t\tif (!wpTempFormDiv.length) {\r\n\t\t\t\tWPAC._Debug(\"error\", \"WordPress' #wp-temp-form-div container not found\", selectorRespondContainer);\r\n\t\t\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar newRespondContainer = extractedBody.find(selectorRespondContainer);\r\n\t\t\tif (!newRespondContainer.length) {\r\n\t\t\t\tWPAC._Debug(\"error\", \"Respond container on requested page not found (selector: '%s')\", selectorRespondContainer);\r\n\t\t\t\tWPAC._LoadFallbackUrl(fallbackUrl);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\twpTempFormDiv.replaceWith(newRespondContainer);\r\n\t\r\n\t\t}\r\n\t\r\n\t\tif (formData) {\r\n\t\t\t// Re-inject saved form data\r\n\t\t\tjQuery.each(formData, function(key, value) {\r\n\t\t\t\tvar formElement = jQuery(\"[name='\"+value.name+\"']\", selectorCommentForm);\r\n\t\t\t\tif (formElement.length != 1 || formElement.val()) return;\r\n\t\t\t\tformElement.val(value.value);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (formFocus) {\r\n\t\t\t// Reset focus\r\n\t\t\tvar formElement = jQuery(\"[name='\"+formFocus+\"']\", selectorCommentForm);\r\n\t\t\tif (formElement) formElement.focus();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Call after update comments.\r\n\tif ( '' !== afterUpdateComments ) {\r\n\t\tconst updateComments = new Function( 'extractedBody', 'commentUrl', afterUpdateComments );\r\n\t\tupdateComments( extractedBody, commentUrl );\r\n\r\n\t\t// Set up native event handler.\r\n\t\tconst updateCommentsEvent = new CustomEvent( 'wpacAfterUpdateComments', { detail: { newDom: extractedBody, commentUrl } } );\r\n\t\tdocument.dispatchEvent( updateCommentsEvent );\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nWPAC._TestCrossDomainScripting = function(url) {\r\n\tif (url.indexOf(\"http\") != 0) return false;\r\n\tvar domain = window.location.protocol + \"//\" + window.location.host;\r\n\treturn (url.indexOf(domain) != 0);\r\n}\r\n\r\nWPAC._TestFallbackUrl = function(url) {\r\n\t// Get URL object.\r\n\tconst urlObject = new URL(url);\r\n\r\n\t// Get query params.\r\n\tconst queryParams = urlObject.searchParams;\r\n\tconst fallbackParam = queryParams.get('WPACFallback');\r\n\tconst randomParam = queryParams.get('WPACRandom');\r\n\r\n\treturn (fallbackParam && randomParam);\r\n}\r\n\r\nWPAC.AttachForm = function(options) {\r\n\r\n\t// Set default options\r\n\toptions = jQuery.extend({\r\n\t\tselectorCommentForm: WPAC._Options.selectorCommentForm,\r\n\t\tselectorCommentPagingLinks: WPAC._Options.selectorCommentPagingLinks,\r\n\t\tbeforeSelectElements: WPACCallbacks.beforeSelectElements,\r\n\t\tbeforeSubmitComment: WPACCallbacks.beforeSubmitComment,\r\n\t\tafterPostComment: WPACCallbacks.afterPostComment,\r\n\t\tselectorCommentsContainer: WPAC._Options.selectorCommentsContainer,\r\n\t\tselectorRespondContainer: WPAC._Options.selectorRespondContainer,\r\n\t\tbeforeUpdateComments: WPACCallbacks.beforeUpdateComments,\r\n\t\tafterUpdateComments: WPACCallbacks.afterUpdateComments,\r\n\t\tscrollToAnchor: !WPAC._Options.disableScrollToAnchor,\r\n\t\tupdateUrl: !WPAC._Options.disableUrlUpdate,\r\n\t\tselectorCommentLinks: WPAC._Options.selectorCommentLinks\r\n\t}, options || {});\t\r\n\r\n\tif (WPAC._Options.debug && WPAC._Options.commentsEnabled) {\r\n\t\tWPAC._Debug(\"info\", \"Attach form...\")\r\n\t\tWPAC._DebugSelector(\"comment form\", options.selectorCommentForm);\r\n\t\tWPAC._DebugSelector(\"comments container\",options.selectorCommentsContainer);\r\n\t\tWPAC._DebugSelector(\"respond container\", options.selectorRespondContainer)\r\n\t\tWPAC._DebugSelector(\"comment paging links\", options.selectorCommentPagingLinks, true);\r\n\t\tWPAC._DebugSelector(\"comment links\", options.selectorCommentLinks, true);\r\n\t}\r\n\r\n\t// Try before submit comment. Using new function is not ideal here, but safer than exec.\r\n\tif ( '' !== WPACCallbacks.beforeSelectElements ) {\r\n\t\tconst beforeSelect = new Function( 'dom', WPACCallbacks.beforeSelectElements );\r\n\t\tbeforeSelect( jQuery(document) );\r\n\r\n\t\t// Set up native event handler.\r\n\t\tconst beforeSelectEvent = new CustomEvent( 'wpacBeforeSelectElements', { detail: { dom: jQuery(document) } } );\r\n\t\tdocument.dispatchEvent( beforeSelectEvent );\r\n\t}\r\n\t\r\n\t// Get addHandler method\r\n\tif (jQuery(document).on) {\r\n\t\t// jQuery 1.7+\r\n\t\tvar addHandler = function(event, selector, handler) {\r\n\t\t\tjQuery(document).on(event, selector, handler)\r\n\t\t}\r\n\t} else if (jQuery(document).delegate) {\r\n\t\t// jQuery 1.4.3+\r\n\t\tvar addHandler = function(event, selector, handler) {\r\n\t\t\tjQuery(document).delegate(selector, event, handler)\r\n\t\t}\r\n\t} else {\r\n\t\t// jQuery 1.3+\r\n\t\tvar addHandler = function(event, selector, handler) {\r\n\t\t\tjQuery(selector).live(event, handler)\r\n\t\t}\r\n\t}\r\n\r\n\t// Handle paging link clicks\r\n\tvar pagingClickHandler = function(event) {\r\n\t\tvar href = jQuery(this).attr(\"href\");\r\n\t\tif (href) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tWPAC.LoadComments(href, {\r\n\t\t\t\tselectorCommentForm: options.selectorCommentForm,\r\n\t\t\t\tselectorCommentsContainer: options.selectorCommentsContainer,\r\n\t\t\t\tselectorRespondContainer: options.selectorRespondContainer,\r\n\t\t\t\tbeforeSelectElements: options.beforeSelectElements,\r\n\t\t\t\tbeforeUpdateComments: options.beforeUpdateComments,\r\n\t\t\t\tafterUpdateComments: options.afterUpdateComments\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\taddHandler(\"click\", options.selectorCommentPagingLinks, pagingClickHandler);\r\n\t\r\n\t// Handle comment link clicks\r\n\tvar linkClickHandler = function(event) {\r\n\t\tvar element = jQuery(this);\r\n\t\tif (element.is(options.selectorCommentPagingLinks)) return; // skip if paging link was clicked \r\n\t\tvar href = element.attr(\"href\");\r\n\t\tvar anchor = \"#\" + (new Uri(href)).anchor();\r\n\t\tif (jQuery(anchor).length > 0) {\r\n\t\t\tif (options.updateUrl) WPAC._UpdateUrl(href);\r\n\t\t\tWPAC._ScrollToAnchor(anchor, options.updateUrl);\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t};\r\n\taddHandler(\"click\", options.selectorCommentLinks, linkClickHandler);\r\n\t\r\n\tif (!WPAC._Options.commentsEnabled) return;\r\n\t\r\n\t// Handle form submit\r\n\tvar formSubmitHandler = function (event) {\r\n\t\tvar form = jQuery(this);\r\n\r\n\t\t// Try before submit comment. Using new function is not ideal here, but safer than exec.\r\n\t\tif ( WPACCallbacks.beforeSubmitComment !== '' ) {\r\n\t\t\tconst beforeSubmit = new Function( 'dom', WPACCallbacks.beforeSubmitComment );\r\n\t\t\tbeforeSubmit( jQuery(document) );\r\n\r\n\t\t\t// Set up native event handler.\r\n\t\t\tconst beforeSubmitEvent = new CustomEvent( 'wpacBeforeSubmitComment', { detail: { dom: jQuery(document) } } );\r\n\t\t\tdocument.dispatchEvent( beforeSubmitEvent );\r\n\t\t\r\n\t\t}\r\n\r\n\t\tvar submitUrl = form.attr(\"action\");\r\n\r\n\t\t// Cancel AJAX request if cross-domain scripting is detected\r\n\t\tif (WPAC._TestCrossDomainScripting(submitUrl)) {\r\n\t\t\tif (WPAC._Options.debug && !form.data(\"submitCrossDomain\")) {\r\n\t\t\t\tWPAC._Debug(\"error\", \"Cross-domain scripting detected (submit url: '%s'), cancel AJAX request\", submitUrl);\r\n\t\t\t\tWPAC._Debug(\"info\", \"Sleep for 5s to enable analyzing debug messages...\");\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tform.data(\"submitCrossDomain\", true)\r\n\t\t\t\twindow.setTimeout(function() { jQuery('#submit', form).remove(); form.submit(); }, 5000);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// Stop default event handling\r\n\t\tevent.preventDefault();\r\n\t\t\r\n\t\t// Test if form is already submitting\r\n\t\tif (form.data(\"WPAC_SUBMITTING\")) {\r\n\t\t\tWPAC._Debug(\"info\", \"Cancel submit, form is already submitting (Form: %o)\", form);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tform.data(\"WPAC_SUBMITTING\", true);\r\n\r\n\t\t// Show loading info\r\n\t\tWPAC._ShowMessage(WPAC._Options.textPostComment, \"loading\");\r\n\r\n\t\tvar handleErrorResponse = function(data) {\r\n\r\n\t\t\tWPAC._Debug(\"info\", \"Comment has not been posted\");\r\n\t\t\tWPAC._Debug(\"info\", \"Try to extract error message (selector: '%s')...\", WPAC._Options.selectorErrorContainer);\r\n\t\t\t\r\n\t\t\t// Extract error message\r\n\t\t\tvar extractedBody = WPAC._ExtractBody(data);\r\n\t\t\tif (extractedBody !== false) {\r\n\t\t\t\tvar errorMessage = extractedBody.find(WPAC._Options.selectorErrorContainer);\r\n\t\t\t\tif (errorMessage.length) {\r\n\t\t\t\t\terrorMessage = errorMessage.html();\r\n\t\t\t\t\tWPAC._Debug(\"info\", \"Error message '%s' successfully extracted\", errorMessage);\r\n\t\t\t\t\tWPAC._ShowMessage(errorMessage, \"error\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tWPAC._Debug(\"error\", \"Error message could not be extracted, use error message '%s'.\", WPAC._Options.textUnknownError);\r\n\t\t\tWPAC._ShowMessage(WPAC._Options.textUnknownError, \"error\");\r\n\t\t}\r\n\t\t\r\n\t\tvar request = jQuery.ajax({\r\n\t\t\turl: submitUrl,\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: form.serialize(),\r\n\t\t\tbeforeSend: function(xhr){ xhr.setRequestHeader('X-WPAC-REQUEST', '1'); },\r\n\t\t\tcomplete: function(xhr, textStatus) { form.removeData(\"WPAC_SUBMITTING\", true); },\r\n\t\t\tsuccess: function (data) {\r\n\r\n\t\t\t\t// Test error state (WordPress >=4.1 does not return 500 status code if posting comment failed)\r\n\t\t\t\tif (request.getResponseHeader(\"X-WPAC-ERROR\")) {\r\n\t\t\t\t\tWPAC._Debug(\"info\", \"Found error state X-WPAC-ERROR header.\", commentUrl);\r\n\t\t\t\t\thandleErrorResponse(data);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tWPAC._Debug(\"info\", \"Comment has been posted\");\r\n\r\n\t\t\t\t// Get info from response header\r\n\t\t\t\tvar commentUrl = request.getResponseHeader(\"X-WPAC-URL\");\r\n\t\t\t\tWPAC._Debug(\"info\", \"Found comment URL '%s' in X-WPAC-URL header.\", commentUrl);\r\n\t\t\t\tvar unapproved = request.getResponseHeader(\"X-WPAC-UNAPPROVED\");\r\n\t\t\t\tWPAC._Debug(\"info\", \"Found unapproved state '%s' in X-WPAC-UNAPPROVED\", unapproved);\r\n\r\n\t\t\t\t// Try afterPostComment submit comment. Using new function is not ideal here, but safer than exec.\r\n\t\t\t\tif ( WPACCallbacks.afterPostComment !== '' ) {\r\n\t\t\t\t\tconst afterComment = new Function( 'commentUrl', 'unapproved', afterPostComment);\r\n    \t\t\t\tafterComment( commentUrl, unapproved == '1');\r\n\r\n\t\t\t\t\t// Set up native event handler.\r\n\t\t\t\t\tconst afterCommentEvent = new CustomEvent( 'wpacAfterPostComment', { detail: { commentUrl, unapproved: unapproved == '1' } } );\r\n\t\t\t\t\tdocument.dispatchEvent( afterCommentEvent );\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Show success message\r\n\t\t\t\tWPAC._ShowMessage(unapproved == '1' ? WPAC._Options.textPostedUnapproved : WPAC._Options.textPosted, \"success\");\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Sunshine Confetti Plugin integration.\r\n\t\t\t\t *\r\n\t\t\t\t * @since 3.0.0\r\n\t\t\t\t *\r\n\t\t\t\t * @see https://wordpress.org/plugins/confetti/\r\n\t\t\t\t */\r\n\t\t\t\tif ( typeof window.wps_launch_confetti_cannon !== 'undefined' ) {\r\n\t\t\t\t\twindow.wps_launch_confetti_cannon();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Replace comments (and return if replacing failed)\r\n\t\t\t\tif (!WPAC._ReplaceComments(data, commentUrl, false, {}, \"\", options.selectorCommentsContainer, options.selectorCommentForm, options.selectorRespondContainer, \r\n\t\t\t\t\toptions.beforeSelectElements, options.beforeUpdateComments, options.afterUpdateComments)) return;\r\n\t\t\t\t\r\n\t\t\t\t// Smooth scroll to comment url and update browser url\r\n\t\t\t\tif (commentUrl) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif (options.updateUrl)\r\n\t\t\t\t\t\tWPAC._UpdateUrl(commentUrl);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (options.scrollToAnchor) {\r\n\t\t\t\t\t\tvar anchor = commentUrl.indexOf(\"#\") >= 0 ? commentUrl.substr(commentUrl.indexOf(\"#\")) : null;\r\n\t\t\t\t\t\tif (anchor) {\r\n\t\t\t\t\t\t\tWPAC._Debug(\"info\", \"Anchor '%s' extracted from comment URL '%s'\", anchor, commentUrl);\r\n\t\t\t\t\t\t\tWPAC._ScrollToAnchor(anchor, options.updateUrl);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\terror: function (jqXhr, textStatus, errorThrown) {\r\n\r\n\t\t\t\t// Test if loading comment url failed (due to cross site scripting error)\r\n\t\t\t\tif (jqXhr.status === 0 && jqXhr.responseText === \"\") {\r\n\t\t\t\t\tWPAC._Debug(\"error\", \"Comment seems to be posted, but loading comment update failed.\");\r\n\t\t\t\t\tWPAC._LoadFallbackUrl(WPAC._AddQueryParamStringToUrl(window.location.href, \"WPACFallback\", \"1\"));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\thandleErrorResponse(jqXhr.responseText);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\taddHandler(\"submit\", options.selectorCommentForm, formSubmitHandler)\r\n}\r\n\r\nWPAC._Initialized = false;\r\nWPAC.Init = function() {\r\n\r\n\t// Test if plugin already has been initialized\r\n\tif (WPAC._Initialized) {\r\n\t\tWPAC._Debug(\"info\", \"Abort initialization (plugin already initialized)\");\r\n\t\treturn false;\r\n\t}\r\n\tWPAC._Initialized = true;\r\n\t\r\n\t// Assert that environment is set up correctly\r\n\tif (!WPAC._Options || !WPACCallbacks) {\r\n\t\tWPAC._Debug(\"error\", \"Something unexpected happened, initialization failed. Please try to reinstall the plugin.\");\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Debug infos\r\n\tWPAC._Debug(\"info\", \"Initializing version %s\", WPAC._Options.version);\r\n\r\n\t// Debug infos\r\n\tif (WPAC._Options.debug) {\r\n\t\tif (!jQuery || !jQuery.fn || !jQuery.fn.jquery) {\r\n\t\t\tWPAC._Debug(\"error\", \"jQuery not found, abort initialization. Please try to reinstall the plugin.\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tWPAC._Debug(\"info\", \"Found jQuery %s\", jQuery.fn.jquery);\r\n\t\tif (!jQuery.blockUI || !jQuery.blockUI.version) {\r\n\t\t\tWPAC._Debug(\"error\", \"jQuery blockUI not found, abort initialization. Please try to reinstall the plugin.\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tWPAC._Debug(\"info\", \"Found jQuery blockUI %s\", jQuery.blockUI.version);\r\n\t\tif (!jQuery.idleTimer) {\r\n\t\t\tWPAC._Debug(\"error\", \"jQuery Idle Timer plugin not found, abort initialization. Please try to reinstall the plugin.\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tWPAC._Debug(\"info\", \"Found jQuery Idle Timer plugin\");\r\n\t}\r\n\r\n\tif (WPAC._Options.selectorPostContainer) {\r\n\t\tWPAC._Debug(\"info\", \"Multiple comment form support enabled (selector: '%s')\", WPAC._Options.selectorPostContainer);\r\n\t\tjQuery(WPAC._Options.selectorPostContainer).each(function(i,e) {\r\n\t\t\tvar id = jQuery(e).attr(\"id\");\r\n\t\t\tif (!id) {\r\n\t\t\t\tWPAC._Debug(\"info\", \"Skip post container element %o (ID not defined)\", e);\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tWPAC.AttachForm({\r\n\t\t\t\tselectorCommentForm: \"#\" + id + \" \" + WPAC._Options.selectorCommentForm,\r\n\t\t\t\tselectorCommentPagingLinks: \"#\" + id + \" \" + WPAC._Options.selectorCommentPagingLinks,\r\n\t\t\t\tselectorCommentsContainer: \"#\" + id + \" \" + WPAC._Options.selectorCommentsContainer,\r\n\t\t\t\tselectorRespondContainer: \"#\" + id + \" \" + WPAC._Options.selectorRespondContainer\r\n\t\t\t});\t\r\n\t\t});\r\n\t} else {\r\n\t\tWPAC.AttachForm();\r\n\t}\r\n\r\n\t// Set up loading preview handlers.\r\n\tjQuery( '#wp-admin-bar-wpac-menu-helper-preview-overlay-loading a' ).on( 'click', function( e ) {\r\n\t\te.preventDefault();\r\n\t\tWPAC._ShowMessage( \"This is the loading preview...\", \"loadingPreview\" );\r\n\t} );\r\n\r\n\t// Set up success preview handlers.\r\n\tjQuery( '#wp-admin-bar-wpac-menu-helper-preview-overlay-success a' ).on( 'click', function( e ) {\r\n\t\te.preventDefault();\r\n\t\tWPAC._ShowMessage( \"This is a success message\", \"success\" );\r\n\t} );\r\n\r\n\t// Set up error preview handlers.\r\n\tjQuery( '#wp-admin-bar-wpac-menu-helper-preview-overlay-error a' ).on( 'click', function( e ) {\r\n\t\te.preventDefault();\r\n\t\tWPAC._ShowMessage( \"This is an error message\", \"error\" );\r\n\t} );\r\n\t\r\n\t// Set up idle timer\r\n\tif (WPAC._Options.commentsEnabled && WPAC._Options.autoUpdateIdleTime > 0) {\r\n\t\tWPAC._Debug(\"info\", \"Auto updating comments enabled (idle time: %s)\", WPAC._Options.autoUpdateIdleTime);\r\n\t\tWPAC._InitIdleTimer();\r\n\t}\r\n\t\r\n\tWPAC._Debug(\"info\", \"Initialization completed\");\r\n\r\n\treturn true;\r\n}\r\n\r\nWPAC._OnIdle = function() {\r\n\tWPAC.RefreshComments({ success: WPAC._InitIdleTimer, scrollToAnchor: false});\r\n};\r\n\r\nWPAC._InitIdleTimer = function() {\r\n\tif (WPAC._TestFallbackUrl(location.href)) {\r\n\t\tWPAC._Debug(\"error\", \"Fallback URL was detected (url: '%s'), cancel init idle timer\", location.href);\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tjQuery(document).idleTimer(\"destroy\");\r\n\tjQuery(document).idleTimer(WPAC._Options.autoUpdateIdleTime);\r\n\tjQuery(document).on(\"idle.idleTimer\", WPAC._OnIdle);\r\n}\r\n\r\nWPAC.RefreshComments = function(options) {\r\n\tvar url = location.href;\r\n\t\r\n\tif (WPAC._TestFallbackUrl(location.href)) {\r\n\t\tWPAC._Debug(\"error\", \"Fallback URL was detected (url: '%s'), cancel AJAX request\", url);\r\n\t\treturn false;   \r\n\t}\r\n\t\r\n\treturn WPAC.LoadComments(url, options)\r\n}\r\n\r\nWPAC.LoadComments = function(url, options) {\r\n\r\n\t// Cancel AJAX request if cross-domain scripting is detected\r\n\tif (WPAC._TestCrossDomainScripting(url)) {\r\n\t\tWPAC._Debug(\"error\", \"Cross-domain scripting detected (url: '%s'), cancel AJAX request\", url);\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Convert boolean parameter (used in version <0.14.0)\r\n\tif (typeof(options) == \"boolean\")\r\n\t\toptions = {scrollToAnchor: options}\r\n\r\n\t// Set default options\r\n\toptions = jQuery.extend({\r\n\t\tscrollToAnchor: !WPAC._Options.disableScrollToAnchor,\r\n\t\tshowLoadingInfo: true,\r\n\t\tupdateUrl: !WPAC._Options.disableUrlUpdate,\r\n\t\tsuccess: function() {},\r\n\t\tselectorCommentForm: WPAC._Options.selectorCommentForm,\r\n\t\tselectorCommentsContainer: WPAC._Options.selectorCommentsContainer,\r\n\t\tselectorRespondContainer: WPAC._Options.selectorRespondContainer,\r\n\t\tdisableCache: WPAC._Options.disableCache,\r\n\t\tbeforeSelectElements: WPACCallbacks.beforeSelectElements, \r\n\t\tbeforeUpdateComments: WPACCallbacks.beforeUpdateComments,\r\n\t\tafterUpdateComments: WPACCallbacks.afterUpdateComments,\r\n\t}, options || {});\t\r\n\t\r\n\t// Save form data and focus\r\n\tvar formData = jQuery(options.selectorCommentForm).serializeArray();\r\n\tvar formFocus = (document.activeElement) ? jQuery(\"[name='\"+document.activeElement.name+\"']\", options.selectorCommentForm).attr(\"name\") : \"\";\r\n\r\n\t// Get query strings form URL (ajaxifyLazyLoadEnable, nonce, post_id).\r\n\tvar urlObject = new URL(url);\r\n\tvar queryParams = urlObject.searchParams;\r\n\tvar ajaxifyLazyLoadEnable = queryParams.get('ajaxifyLazyLoadEnable');\r\n\tvar nonce = queryParams.get('nonce');\r\n\tvar postId = queryParams.get('post_id');\r\n\r\n\t// Add to URL.\r\n\turl = WPAC._AddQueryParamStringToUrl(url, 'ajaxifyLazyLoadEnable', ajaxifyLazyLoadEnable);\r\n\turl = WPAC._AddQueryParamStringToUrl(url, 'nonce', nonce);\r\n\turl = WPAC._AddQueryParamStringToUrl(url, 'post_id', postId);\r\n\t\r\n\t// Show loading info\r\n\tif (options.showLoadingInfo)\r\n\t\tWPAC._ShowMessage(WPAC._Options.textRefreshComments, \"loading\");\r\n\r\n\tif (options.disableCache) \r\n\t\turl = WPAC._AddQueryParamStringToUrl(url, \"WPACRandom\", (new Date()).getTime());\r\n\t\t\r\n\tvar request = jQuery.ajax({\r\n\t\turl: url,\r\n\t\ttype: \"GET\",\r\n\t\tbeforeSend: function(xhr){ xhr.setRequestHeader(\"X-WPAC-REQUEST\", \"1\"); },\r\n\t\tsuccess: function (data) {\r\n\t\t\ttry {\r\n\t\t\t\t// Replace comments (and return if replacing failed)\r\n\t\t\t\tif (!WPAC._ReplaceComments(data, url, true, formData, formFocus, options.selectorCommentsContainer, options.selectorCommentForm, \r\n\t\t\t\t\toptions.selectorRespondContainer, options.beforeSelectElements, options.beforeUpdateComments, options.afterUpdateComments)) return;\r\n\t\t\t\t\r\n\t\t\t\tif (options.updateUrl) WPAC._UpdateUrl(url);\r\n\r\n\t\t\t\t// Scroll to anchor\r\n\t\t\t\tvar waitForScrollToAnchor = false;\r\n\t\t\t\tif (options.scrollToAnchor) {\r\n\t\t\t\t\tvar anchor = url.indexOf(\"#\") >= 0 ? url.substr(url.indexOf(\"#\")) : null;\r\n\t\t\t\t\tif (anchor) {\r\n\t\t\t\t\t\tWPAC._Debug(\"info\", \"Anchor '%s' extracted from url\", anchor);\r\n\t\t\t\t\t\tif (WPAC._ScrollToAnchor(anchor, options.updateUrl, function() { options.success(); } )) {\r\n\t\t\t\t\t\t\twaitForScrollToAnchor = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} catch ( e ) {\r\n\t\t\t\tWPAC._Debug( 'error', 'Something went wrong while refreshing comments: %s', e );\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Unblock UI\r\n\t\t\tjQuery.unblockUI();\r\n\t\t\t\r\n\t\t\tif (!waitForScrollToAnchor) options.success();\r\n\t\t},\r\n\t\terror: function() {\r\n\t\t\tWPAC._LoadFallbackUrl(WPAC._AddQueryParamStringToUrl(window.location.href, \"WPACFallback\", \"1\"))\r\n\t\t} \r\n\t\t\r\n\t});\r\n\t\r\n\treturn true;\r\n}\r\n\r\njQuery(function() {\r\n\tvar initSuccesful = WPAC.Init();\r\n\tif (true === WPAC._Options.lazyLoadEnabled) {\r\n\t\t\r\n\r\n\t\tif (!initSuccesful) {\r\n\t\t\tWPAC._LoadFallbackUrl(WPAC._AddQueryParamStringToUrl(window.location.href, \"WPACFallback\", \"1\"))\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar asyncLoadTrigger = WPAC._Options.asyncLoadTrigger;\r\n\t\tWPAC._Debug(\"info\", \"Loading comments asynchronously with secondary AJAX request (trigger: '%s')\", asyncLoadTrigger);\r\n\t\t\r\n\t\tif (window.location.hash) {\r\n\t\t\tvar regex = /^#comment-[0-9]+$/;\r\n\t\t\tif (regex.test(window.location.hash)) {\r\n\t\t\t\tWPAC._Debug(\"info\", \"Comment anchor in URL detected, force loading comments on DomReady (hash: '%s')\", window.location.hash);\r\n\t\t\t\tasyncLoadTrigger = \"DomReady\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (asyncLoadTrigger == \"Viewport\") {\r\n\t\t\tjQuery(WPAC._Options.selectorCommentsContainer).waypoint(function(direction) {\r\n\t\t\t\tthis.destroy();\r\n\t\t\t\tWPAC.RefreshComments();\r\n\t\t\t}, { offset: \"100%\" });\r\n\t\t} else if (asyncLoadTrigger == \"DomReady\") {\r\n\t\t\tWPAC.RefreshComments({scrollToAnchor: true}); // force scroll to anchor\r\n\t\t}\r\n\t} \r\n});\r\n\r\nfunction wpac_init() {\r\n\tWPAC._Debug(\"info\", \"wpac_init() is deprecated, please use WPAC.Init()\");\r\n\tWPAC.Init();\r\n}"],"names":["WPAC","_Options","_BodyRegex","RegExp","_ExtractBody","html","jQuery","exec","e","_TitleRegex","_ExtractTitle","_ShowMessage","message","type","top","popupMarginTop","outerHeight","backgroundColor","popupBackgroundColorLoading","textColor","popupTextColorLoading","popupBackgroundColorError","popupTextColorError","popupBackgroundColorSuccess","popupTextColorSuccess","blockUI","blockMsgClass","fadeIn","popupFadeIn","fadeOut","popupFadeOut","timeout","popupTimeout","centerY","centerX","showOverlay","css","width","popupWidth","left","border","padding","popupPadding","popupCornerRadius","opacity","popupOpacity","color","textAlign","popupTextAlign","cursor","popupTextFontSize","overlayCSS","baseZ","popupZindex","_DebugErrorShown","_Debug","level","debug","Function","prototype","call","bind","window","console","_typeof","log","apply","alert","args","merge","makeArray","arguments","slice","_DebugSelector","elementType","selector","optional","element","length","_AddQueryParamStringToUrl","url","param","value","urlObject","URL","queryParams","searchParams","set","search","toString","_LoadFallbackUrl","fallbackUrl","textReloadPage","Date","getTime","reload","location","href","setTimeout","_ScrollToAnchor","anchor","updateHash","scrollComplete","anchorElement","scrollSpeed","animateComplete","hash","scrollTargetTopOffset","offset","scrollTop","animate","duration","complete","_UpdateUrl","split","history","replaceState","document","title","_ReplaceComments","data","commentUrl","useFallbackUrl","formData","formFocus","selectorCommentsContainer","selectorCommentForm","selectorRespondContainer","beforeSelectElements","beforeUpdateComments","afterUpdateComments","oldCommentsContainer","filter","children","is","extractedBody","beforeSelect","beforeSelectEvent","CustomEvent","detail","dispatchEvent","newCommentsContainer","find","beforeComments","beforeCommentsEvent","newDom","extractedTitle","text","replaceWith","commentsEnabled","form","parents","newCommentForm","wpTempFormDiv","newRespondContainer","each","key","formElement","name","val","focus","updateComments","updateCommentsEvent","_TestCrossDomainScripting","indexOf","domain","protocol","host","_TestFallbackUrl","fallbackParam","get","randomParam","AttachForm","options","extend","selectorCommentPagingLinks","WPACCallbacks","beforeSubmitComment","afterPostComment","scrollToAnchor","disableScrollToAnchor","updateUrl","disableUrlUpdate","selectorCommentLinks","dom","on","addHandler","event","handler","delegate","live","pagingClickHandler","attr","preventDefault","LoadComments","linkClickHandler","Uri","formSubmitHandler","beforeSubmit","beforeSubmitEvent","submitUrl","remove","submit","textPostComment","handleErrorResponse","selectorErrorContainer","errorMessage","textUnknownError","request","ajax","serialize","beforeSend","xhr","setRequestHeader","textStatus","removeData","success","getResponseHeader","unapproved","afterComment","afterCommentEvent","textPostedUnapproved","textPosted","wps_launch_confetti_cannon","substr","error","jqXhr","errorThrown","status","responseText","_Initialized","Init","version","fn","jquery","idleTimer","selectorPostContainer","i","id","autoUpdateIdleTime","_InitIdleTimer","_OnIdle","RefreshComments","showLoadingInfo","disableCache","serializeArray","activeElement","ajaxifyLazyLoadEnable","nonce","postId","textRefreshComments","waitForScrollToAnchor","unblockUI","initSuccesful","lazyLoadEnabled","asyncLoadTrigger","regex","test","waypoint","direction","destroy","wpac_init"],"sourceRoot":""}